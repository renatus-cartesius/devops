# TCP\IP сети. Часть 1
Данная аннотация будет разделена на две части: в первой части описывается теоритическая база TCP\IP сетей, во-второй - различные процессы конфигурации(динамической и мануальной) хостов и шлюзов.
## Вкратце.  Определение IP-сети и роль в ней стека TCP\IP
Информационная сеть - это физическая или логическая сущность, которая состоит из объектов - узлов сети, соедиенный друг с другом посредством физических кабелей(если это локальная сеть) или туннелирования (если это виртуальная локальная сеть).  

Стек TCP\IP - это стек протоколов, которые позволяют коммуницировать двум и более(broadcast) узлам, имея уникальный $4$-х или $16$-ти байтный адрес и назначеный порт.  
****
## Основные понятия сетей
### Пакет
Пакет - основная состовляющая единица общения в сети. По факту - это лишь последовательность байт, которая имеет строгую структуру, состоящую из различных протоколов, вложенных друг в друга.
### Протокол
Чтобы пакет не казался хаотичной последовательностью байт, нужно придерживаться строгих правил его составления. В этом помогает использование сетевых протоколов. Протокол, грубо говоря, - набор соглашений на интерпретацию какой-то информации. Например, рассмотрим абстрактный пример:
 
 *Протокол A - должен состоять следующим образом*
 - Первые четыре байта - адрес получателя
 - Последующие четыре байта - адрес получателя
 - Оставшиеся $120$ байт - какая-то полезная нагрузка(сообщение, картинка(или ее фрагмент))

Таким образом, был стандартизирован протокол А, состоящий из $128 (2^7)$  байт и несущий в себе достаточно(если мы прослушиваем на всех портах) информации, чтобы определить получателя и отправителя.
### Инкапсуляция и OSI
В идеальном мире - каждый протокол отвечает за свой уровень абстракции OSI. OSI - это соглашение по формированию конечного пакета, которое разделяет его на несколько слоев:
1. Канальный - самый низкоуровневый слой пакета, который отвечает за адресацию между физическими устройствами
2. Сетевой - отвечает за адресацию между узлами в сети
3. Транспортный - отвечает за адресацию между процессами ([[processes]])
4. Прикладной - несет информацию, с которой работает процесс адресата.
Более высокоуровневый слой, вложеный в более низкоуровневый, не зависит от низкоуровневых, но низкоуровневые знают и содерат определеяющую информацию о своем высокоуровневом соседе. Данный механизм вложения называется **инкапсуляцией**. 
****
## TCP\IP стек и что он из себя представляет
### Немного про ARP, MAC и ICMP
ARP - протокол резолюции адресов: его назначение очень просто - получить из IP-адреса физический и наоборот. MAC - тот самый физический адрес из предыдущего предложения: каждый физический сетевой интерфейс(будь то сетевая карта материнской платы, или WiFi карта, или сетевая карта умного телевизора и пр.) имеет свой уникальный MAC-адрес. ICMP - протокол
### Протокол IP и его строение
 Протокол IP предназначен для маршрутизации пакета в IP-сети. Он состоит из адреса отправителя и получателя, различных флагов, идентифицирующих  инкапсулированный в него протокол, размера полезной нагрузки, контрольный суммы и прочего. 
### Протокол TCP и его строение
 Протокол TCP является транспортным и отвечает за коммуникацию между процессами. Вместо адреса, TCP несет в себе значения порта отправителя и получателя. В отличии от UDP, использует поток данных с предварительной установкой соединения и осуществляет повторный запрос данных в случае потери.  
### Маска подсети. Адрес сети. Классовая и бесклассовая адресация (CIDR)
IP-адреса с издавна принято классифицировать в группы. Для такой классификации принято использовать маски подсети, которые определяют сколько из $32$ бит(если это IPv4(хотя в IPv6 особо смысла использовать маски нет)) будет отведено под адрес сети(оставшиеся биты отводятся узлам). 
IP-адрес, с использованием маски подсети, может отображать не только адрес машины в сети, но и адрес самой сети(или пограничного маршрутизатора) 
Пространство IP-адресов раньше было принято разделять на пять классов:

1. A - N.X.X.X : самые первые сети или адреса, зарезервированные для Минестерства Обороны США
2. B - N.N.X.X : крупные корпоративные сети
3. C - N.N.N.X : сети небольших организаций
4. D - групповые адреса, не назначаемые на постоянной основе
5. E - экспериментальные адреса 

В данном случае, классов всего лишь пять, так как используется старый метод классификации. Сейчас же, существует такая полезная вещь, как CIDR - Classless Interdomain Routing - безклассовая междоменная маршрутизация. На самом деле, классы в CIDR есть и их ровно $32$. Чтобы записать адрес сети с маской в данной нотации, нужно после адреса сети написать слэш с числом от $0$ до $31$, что будет являться количеством битов, отведенных на определение адреса сети.
****
## Маршрутизация IP сетей
Чтобы пакет дошел от отправителя до получателя, необходимо выстроить маршрут внутри сети. Под выстраиванием машрута предполагается подбор узлов в данной сети так, чтобы количетство узлов было минимальным.
### Шлюз
Так как Интернет по сути своей является большой сетью, состоящей из множества частных сетей, то у каждой такой частной сети должна быть точка входа, через которую внутренние хосты могут общаться с хостами из других сетей. Такой точкой входа называют шлюз. Шлюз - это аппаратное обеспечение (маршрутизатор, свитч, коммутатор и др), которое разделяет внутреннюю сеть от внешней. 
### NAT
Когда мы разделяем внутреннюю сеть и внешнюю становится потребность преобразовании адресов между пограничным маршрутизатором и внутренним хосто, путем трансляции адреса локального хоста во внешний адрес. Также, есть возможность трансляции порта в адрес - в зависимости от порта транзитного пакета 
### Таблица маршрутизации
Таблица маршрутизации предназначена для сопоставления определенного шлюза и интерфеса с конкретной сетью.