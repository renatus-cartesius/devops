# TCP\IP сети. Часть 2 
В второй части данной аннотации будет разобрано несколько полезных при конфигурировании сетей инструментов, а также quazibest practices для траблшутинга, мониторинга. Помимо всего прочего, во второй части покроется база работы с межсетевым экраном ядра Linux - netfilter, посредством iptables. Ну, и напоследок - будут разложены основы работы с виртуальным частным облаком.

## Основные методы конфигурирования
### Изменение параметров ядра и sysctl
Задавать параметры каждого интерфейса можно через переменные ядра, которые располагаются в **procfs** по пути /proc/sys/net. Можно менять значения и вручную. А можно и пользоваться утилитой **sysctl**, которая позваляет конфигурировать параметры ядра прямо во время исполнения.

## Инструменты для устранения неполадок (troubleshooting)
### ping
Команда ping предназначена для опрашивания хостов, путем отправки ICMP echo пакетов. Инструмент ping имеет дополнительную функциональность в виде замера показателей потери пакетов, задержки соединения и прочего. Также, вся информация выдается как *max/min/average*.
### traceroute
Чтобы отследить путь пакета можно воспользоваться утилитой **traceroute**. В качестве аргумета подается IP адрес или имя DNS. В качестве параметров можо выбрать максимальную длину "прыжков" (hops - количество хостов, грубо говоря) и размер отправляемого пакета. Вся информация выдается в виде списка с соответсвующим IP и промежутком, за который пакет достиг данного хоста.
### tcpdump, wireshark и tshark
Опрашивать хосты и трассировать пакеты не всегда помогает в устранении неисправностей. Немаловажным встает потребность в полном конмым примитивным и старым из популярных снифферов явлтроле трафика пакетов. Программы, которые позволяют просматривать весь трафик, который идет через определенный сетевой интерфейс, называются sniffers. Саяется **tcpdump**. Хоть и его функционал довольно скуден, отслеживать и работать с трафиком можно вполне себе комфортно.

Самым популярным из нового поколения снифферов с открым исходным кодом является Wireshark(Tshark - его терминальная оболочка). В отличии от **tcpdump**, **Wireshark** имеет фильтры отображения, которые намного сильнее синтаксиса *libpcap*. Графический интерейс Wireshark содержит в себе пакетный диссектор - "штуку", которая автоматически разбирает пакет на протоколы, а протоколы на поля. Различная метаинформация, которая вычисляется ужем самим пакетным анализатором(такая как время доставки пакета,  размер фрейма и пр.) заключается в квадратных скобках и располагается вместе в полями протоколов.

## Мониторинг
Мониторинг состояния сети и всей прилегающей к ней инфраструктуры является неотъемлемой частью сетевого администрирования.
### IPerf, speedtest-cli
Пропускную способность между двумя хостами можно замерить с помощью утилиты IPerf. Для этого необходимо запустить оба экземпляра программы на двух маршрутизируемых хостах.
### Cacti
Cacti регистрирует различные показатели производительности хоста за неделю и выдает это в красивом виде. Он построен на основе СУБД циклической базы данных RRD. Хостится на Apache2 или lighthttpd. 
### SmokePing
Периодически пингует сеть и выдает показатели в виде красивых графиков.

## iptables и netfilter
### Правило
Правило в iptables представляет собой запись 
### Цепочка
### Таблица
### Таблицы mangle и nat
### ufw