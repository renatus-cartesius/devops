# Журналирование в Linux
## Как ведется журналирование в Linux и что это такое.
Чтобы узнать явную причину отказа машины (удаленной или локальной), необходимо иметь "под рукой" записи всех ее состояний, которые регистрировались за n-ое время назад. Такие записи называются журналами регистрации или логами. Каждый лог - это набор записей, которые состоят из временной метки и полезной нагрузки. Логи могут быть представленны в виде обычных текстовых файлов, удобночитаемых для человека, или в виде бинарных файлов, удобных для индексации машиной. Создаются такие файлы автоматически специальными демонами. Два наиболее популярных демона логирования для Linux: **Syslog** и **journald**. В качестве более современной версии **syslog** используется **rsyslog**.
****
## Процесс сбора информации
Обычно, подобные системы собирают информацию, которая является зарегистрированным состоянием других демонов, со специальных сокетов и файлов устройств, в которые вторые пишут самостоятельно:
1. Сокет **/dev/log**
2. Файл устройства **/dev/kmsg** (для сбора сообщений от ядра)
3. Сокет **/run/systemd/journal/stdout**
4. Сокет **/run/systemd/journal**

После чтения зарегистрированного состояния, демон логирования записывает их в определенный уникальный файл, который предназначен демону, чью состояние было зарегистрированно.

То есть, по сути - демон логирования лишь посредник, который сортирует сообщения из сокета по отдельным файлам.
****
## Демоны RSyslog и journald
#### RSyslog
Данная система старше, чем ее конкурент и, соответсвенно, имеет немного больше функционала. Например, **syslog**, в современной реализации **rsyslog**, поддерживает свой собственный синтаксис конфигурации **RainerScript**, позволяет пересылать и принимать сообщения регистрации о сети, классифицировать каждой сообщение регистрации по уровню приоритета.
#### journald
**journald** - подсистема логирования от демона systemd. Она представляет собой такой же демон, который конфигурируется в unit файле как и все демоны, управляющиеся systemd ([[boot]]). 
#### Различия и сходства
Главное отличие **journald** от **rsyslog** в том, что логи **journald** представлены в виде бинарных файлов и чтение таковых для человека(даже самого лютого системного администратора) - задача не из легких. Для этого существует утилита **journalctl**, которая очень гибкая и многофункциональная. Также, **journalctl** не имеет нативной реализации отправки и принятия сообщения регистрации по сети, в отличии от **rsyslog**, который работает как по **TCP**, так и по **UDP**. Конфигурируется **rsyslog** в отдельном файле **/etc/rsyslog.conf**, который, как было сказно ранее, имеет свой собственный синтаксис, а **journalctl** - в unit файле.